<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .navbar { background-color: #007bff; }
        .navbar-brand, .nav-link { color: white !important; }
        .card { border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .kpi-icon { font-size: 2rem; color: #007bff; }
        .table thead { background-color: #007bff; color: white; }
        h1, h2 { color: #343a40; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">Sales Dashboard</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        <h1><i class="bi bi-speedometer2 me-2"></i>Dashboard</h1>
        <div class="row">
            <div class="col-md-3 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-currency-dollar kpi-icon"></i>
                        <h5 class="card-title">Total Sales Today</h5>
                        <p class="card-text fw-bold">${{ total_sales_today }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-people kpi-icon"></i>
                        <h5 class="card-title">Number of Clients</h5>
                        <p class="card-text fw-bold">{{ num_clients }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-star-fill kpi-icon"></i>
                        <h5 class="card-title">Best-selling Product</h5>
                        <p class="card-text fw-bold">{{ best_product }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-box-seam kpi-icon"></i>
                        <h5 class="card-title">Remaining Stock</h5>
                        <p class="card-text fw-bold">{{ total_remaining }} units</p>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="mt-4"><i class="bi bi-cart-fill me-2"></i>Sales</h2>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Salesperson</th>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Date</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sale in sales_table %}
                    <tr>
                        <td>{{ sale.salesperson }}</td>
                        <td>{{ sale.product }}</td>
                        <td>{{ sale.quantity }}</td>
                        <td>{{ sale.date }}</td>
                        <td>${{ sale.price | round(2) }}</td>
                        <td>${{ sale.total | round(2) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <h2 class="mt-4"><i class="bi bi-archive-fill me-2"></i>Inventory</h2>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Initial Stock</th>
                        <th>Units Sold</th>
                        <th>Remaining Stock</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in inventory_table %}
                    <tr>
                        <td><a href="/product/{{ item.id }}" class="text-decoration-none">{{ item.product }}</a></td>
                        <td>{{ item.initial_stock }}</td>
                        <td>{{ item.units_sold }}</td>
                        <td>{{ item.remaining_stock }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <h2 class="mt-4"><i class="bi bi-person-lines-fill me-2"></i>Clients</h2>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Client Name</th>
                        <th>Contact Info</th>
                        <th>Last Purchased Product</th>
                    </tr>
                </thead>
                <tbody>
                    {% for client in clients_table %}
                    <tr>
                        <td>{{ client.name }}</td>
                        <td>{{ client.contact }}</td>
                        <td>{{ client.last_product }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>